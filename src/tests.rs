use crate::core::config::get_config;
use crate::core::interpreters::{ByteInterpreter, EscHandler};
use crate::core::serial::SerialChannel;
use crate::interop::opos::{ESC, EXCLAMATION, MINUS, UPPER_O};

#[test]
fn test_config() {
    let config = get_config("root_files/config.toml").unwrap();
    let _ = dbg!(config);
}

#[test]
fn test_serial_port() {
    let pair = SerialChannel::from_config("root_files/config.toml").unwrap();
    dbg!(pair);
}

#[test]
fn test_interpretables() {
    let buffer = [
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
        ESC, MINUS, 44, 9,
    ];
    let mut interpreter = ByteInterpreter::new(&buffer);
    let esc_handler = EscHandler::new();
    interpreter.add_interpretable(ESC, Box::new(esc_handler));
    let result = interpreter.interpret_buffer().unwrap();
    dbg!(result);
}